---
const target = "2025-06-19T18:45:00+05:30";
---

<div class="text-grey-300 text-center mt-10">
  <div
    id="countdown"
    class="text-2xl md:text-3xl font-semibold mt-6 cursor-pointer select-none"
  >
  </div>
  <p id="caption" class="mt-2 text-lg italic text-grey-200"></p>
</div>

<script type="module" is:inline define:vars={{ target }}>
  import confetti from "https://cdn.skypack.dev/@tsparticles/confetti";

  document.addEventListener("DOMContentLoaded", () => {
    const countdownEl = document.getElementById("countdown");
    const captionEl = document.getElementById("caption");

    const targetDate = new Date(target).getTime();

    countdownEl.addEventListener("hover", () => {
      confetti({
        particleCount: 100,
        spread: 90,
        origin: { y: 0.6 },
      });
    });

    function updateCountdown() {
      const now = new Date().getTime();
      const distance = targetDate - now;
      const after = now - targetDate;

      // Logic block
      if (distance > 60 * 60 * 1000) {
        const days = Math.floor(distance / (1000 * 60 * 60 * 24));
        const hours = Math.floor(
          (distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)
        );
        const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((distance % (1000 * 60)) / 1000);
        countdownEl.innerHTML = `${days}d ${hours}h ${minutes}m ${seconds}s`;
        captionEl.textContent = "In Sha Allah";
      } else if (distance <= 60 * 60 * 1000 && distance > 0) {
        // Less than 1 hour remaining
        const minutes = Math.floor(distance / (1000 * 60));
        const seconds = Math.floor((distance % (1000 * 60)) / 1000);
        countdownEl.innerHTML = `${minutes}m ${seconds}s`;
        captionEl.textContent = "ðŸ•Œ Come to the Masjid!";
      } else if (after <= 1.5 * 60 * 60 * 1000) {
        countdownEl.innerHTML = "âœ¨ The Blessed Nikah has begun!";
        captionEl.textContent = "";
      } else if (after <= 6 * 60 * 60 * 1000) {
        countdownEl.innerHTML = "ðŸ’’ The Valima has begun!";
        captionEl.textContent = "";
      } else {
        countdownEl.innerHTML =
          "ðŸŒ™ Alhamdulillah, may ALLAH SWT bless the couple. Aameen ðŸ¤²";
        captionEl.textContent = "";
      }
    }

    updateCountdown();
    setInterval(updateCountdown, 1000);
  });
</script>
